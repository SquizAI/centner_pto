(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6944],{36411:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>A});var a=t(95155),l=t(12115),r=t(20063),i=t(96648),n=t(3998),c=t(65142),o=t(76444),d=t(31120),u=t(86948),h=t(11186),m=t(44846),p=t(11647),x=t(18720),g=t(35626),j=t(6191),f=t(21190),v=t(71360),b=t(16485),y=t(45345),N=t(57249),w=t(16082),_=t(71431),C=t(15239),I=t(52619),k=t.n(I);function A(){(0,r.useRouter)();let e=(0,i.U)(),[s,t]=(0,l.useState)(!1),[I,A]=(0,l.useState)([]),[S,P]=(0,l.useState)(null),[E,F]=(0,l.useState)(!1),[T,Z]=(0,l.useState)({title:"",slug:"",excerpt:"",content:"",campus:"all",featured_image_url:"",tags:[],published:!1,publish_date:""}),[z,B]=(0,l.useState)("");(0,l.useEffect)(()=>{J()},[]);let J=async()=>{try{let{data:s,error:t}=await e.from("news_posts").select("*").order("created_at",{ascending:!1});if(t)throw t;A(s||[])}catch(e){console.error("Error loading posts:",e),x.o.error("Failed to load posts")}},R=(e,s)=>{if(Z(t=>({...t,[e]:s})),"title"===e&&!S){let e=s.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");Z(s=>({...s,slug:e}))}},$=()=>{z.trim()&&!T.tags.includes(z.trim())&&(Z(e=>({...e,tags:[...e.tags,z.trim()]})),B(""))},G=async s=>{s.preventDefault(),t(!0);try{let{data:{user:s},error:t}=await e.auth.getUser();if(t||!s)return void x.o.error("You must be logged in to manage news");let a={title:T.title,slug:T.slug,excerpt:T.excerpt||null,content:T.content,campus:T.campus,featured_image_url:T.featured_image_url||null,tags:T.tags.length>0?T.tags:null,published:T.published,publish_date:T.publish_date||new Date().toISOString(),author_id:s.id};if(S){let{error:s}=await e.from("news_posts").update(a).eq("id",S.id);if(s)throw s;x.o.success("Post updated successfully!")}else{let{error:s}=await e.from("news_posts").insert([a]);if(s)throw s;x.o.success("Post created successfully!")}U(),J()}catch(e){console.error("Error saving post:",e),x.o.error(e instanceof Error?e.message:"Failed to save post")}finally{t(!1)}},D=async s=>{if(confirm("Are you sure you want to delete this post?"))try{let{error:t}=await e.from("news_posts").delete().eq("id",s);if(t)throw t;x.o.success("Post deleted successfully"),J()}catch(e){console.error("Error deleting post:",e),x.o.error("Failed to delete post")}},U=()=>{P(null),Z({title:"",slug:"",excerpt:"",content:"",campus:"all",featured_image_url:"",tags:[],published:!1,publish_date:""}),F(!1)};return E?(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:S?"Edit Post":"Create New Post"}),(0,a.jsxs)(n.$,{variant:"outline",onClick:U,children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Back to List"]})]}),(0,a.jsxs)("form",{onSubmit:G,className:"space-y-6",children:[(0,a.jsxs)(u.Zp,{children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsx)(u.ZB,{children:"Basic Information"}),(0,a.jsx)(u.BT,{children:"Essential post details"})]}),(0,a.jsxs)(u.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"title",children:"Post Title *"}),(0,a.jsx)(c.p,{id:"title",value:T.title,onChange:e=>R("title",e.target.value),placeholder:"e.g., Spring Festival Recap",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"slug",children:"URL Slug *"}),(0,a.jsx)(c.p,{id:"slug",value:T.slug,onChange:e=>R("slug",e.target.value),placeholder:"spring-festival-recap",required:!0}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Will be used in the URL: /news/",T.slug]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(o.J,{htmlFor:"excerpt",children:"Excerpt"}),(0,a.jsx)(w.Y,{onApply:e=>R("excerpt",e),contentType:"news",currentContent:T.excerpt,context:{title:T.title,description:T.content,campus:[T.campus]}})]}),(0,a.jsx)(d.T,{id:"excerpt",value:T.excerpt,onChange:e=>R("excerpt",e.target.value),placeholder:"Brief summary of the post...",rows:2})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(o.J,{htmlFor:"content",children:"Content *"}),(0,a.jsx)(w.Y,{onApply:e=>R("content",e),contentType:"news",currentContent:T.content,context:{title:T.title,description:T.excerpt,campus:[T.campus]}})]}),(0,a.jsx)(d.T,{id:"content",value:T.content,onChange:e=>R("content",e.target.value),placeholder:"Write your post content here...",rows:10,required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"campus",children:"Campus *"}),(0,a.jsxs)(h.l6,{value:T.campus,onValueChange:e=>R("campus",e),children:[(0,a.jsx)(h.bq,{children:(0,a.jsx)(h.yv,{})}),(0,a.jsxs)(h.gC,{children:[(0,a.jsx)(h.eb,{value:"all",children:"All Campuses"}),(0,a.jsx)(h.eb,{value:"preschool",children:"Preschool"}),(0,a.jsx)(h.eb,{value:"elementary",children:"Elementary"}),(0,a.jsx)(h.eb,{value:"middle-high",children:"Middle & High School"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{htmlFor:"publish_date",children:"Publish Date"}),(0,a.jsx)(c.p,{id:"publish_date",type:"date",value:T.publish_date,onChange:e=>R("publish_date",e.target.value)})]})]})]})]}),(0,a.jsx)(N.A,{title:"Generate Featured Image",description:"Use AI to create a custom featured image for this post",onImageGenerated:e=>{R("featured_image_url",e),x.o.success("Image added to post!")},defaultPrompt:"".concat(T.title,", professional blog post hero image, vibrant colors, school community theme"),category:"news"}),T.featured_image_url&&(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsx)(u.ZB,{children:"Featured Image"})}),(0,a.jsxs)(u.Wu,{children:[(0,a.jsx)("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden",children:(0,a.jsx)(C.default,{src:T.featured_image_url,alt:"Featured image",fill:!0,className:"object-cover"})}),(0,a.jsx)(n.$,{type:"button",variant:"outline",className:"mt-4",onClick:()=>R("featured_image_url",""),children:"Remove Image"})]})]}),(0,a.jsxs)(u.Zp,{children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"w-5 h-5"}),"Tags"]}),(0,a.jsx)(u.BT,{children:"Add tags to help organize posts"})]}),(0,a.jsxs)(u.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.p,{value:z,onChange:e=>B(e.target.value),placeholder:"Enter a tag",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),$())}}),(0,a.jsx)(n.$,{type:"button",onClick:$,children:"Add"})]}),T.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:T.tags.map(e=>(0,a.jsxs)(p.E,{variant:"secondary",className:"cursor-pointer",onClick:()=>{Z(s=>({...s,tags:s.tags.filter(s=>s!==e)}))},children:[e,(0,a.jsx)("span",{className:"ml-2",children:"\xd7"})]},e))})]})]}),(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsx)(u.ZB,{children:"Publishing Settings"})}),(0,a.jsx)(u.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(o.J,{children:"Publish Post"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Make this post visible to the public"})]}),(0,a.jsx)(m.d,{checked:T.published,onCheckedChange:e=>R("published",e)})]})})]}),T.published&&(0,a.jsxs)(u.Zp,{children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsx)(u.ZB,{children:"Share Post"}),(0,a.jsx)(u.BT,{children:"Share this news post on social media"})]}),(0,a.jsx)(u.Wu,{children:(0,a.jsx)(_.g,{sourceContent:"".concat(T.title,"\n\n").concat(T.excerpt||T.content),sourceTitle:T.title,sourceImage:T.featured_image_url,onPost:e=>{e.success&&x.o.success("Post shared to ".concat(e.platforms.join(" and "),"!"))}})})]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-end",children:[(0,a.jsx)(n.$,{type:"button",variant:"outline",onClick:U,children:"Cancel"}),(0,a.jsx)(n.$,{type:"submit",disabled:s,children:s?"Saving...":S?"Update Post":"Create Post"})]})]})]}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Manage News"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Create and manage news posts"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(k(),{href:"/admin",children:(0,a.jsxs)(n.$,{variant:"outline",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Back to Admin"]})}),(0,a.jsxs)(n.$,{onClick:()=>F(!0),children:[(0,a.jsx)(j.A,{className:"w-4 h-4 mr-2"}),"Create New Post"]})]})]}),0===I.length?(0,a.jsx)(u.Zp,{children:(0,a.jsx)(u.Wu,{className:"py-8 text-center",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No news posts yet. Create your first post!"})})}):(0,a.jsx)("div",{className:"grid gap-4",children:I.map(e=>(0,a.jsx)(u.Zp,{children:(0,a.jsx)(u.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex gap-4",children:[e.featured_image_url&&(0,a.jsx)("div",{className:"relative w-32 h-32 rounded-lg overflow-hidden flex-shrink-0",children:(0,a.jsx)(C.default,{src:e.featured_image_url,alt:e.title,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.excerpt})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>{P(e),Z({title:e.title,slug:e.slug,excerpt:e.excerpt||"",content:e.content,campus:e.campus,featured_image_url:e.featured_image_url||"",tags:e.tags||[],published:e.published||!1,publish_date:e.publish_date?e.publish_date.split("T")[0]:""}),F(!0)},children:(0,a.jsx)(f.A,{className:"w-4 h-4"})}),(0,a.jsx)(n.$,{variant:"destructive",size:"sm",onClick:()=>D(e.id),children:(0,a.jsx)(v.A,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 items-center text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"w-4 h-4"}),new Date(e.publish_date||e.created_at||"").toLocaleDateString()]}),(0,a.jsx)(p.E,{variant:"outline",children:e.campus}),e.tags&&e.tags.map(e=>(0,a.jsxs)(p.E,{variant:"secondary",children:[(0,a.jsx)(y.A,{className:"w-3 h-3 mr-1"}),e]},e))]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(e.published?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.published?"Published":"Draft"})})]})]})})},e.id))})]})}},43217:(e,s,t)=>{Promise.resolve().then(t.bind(t,36411))},44846:(e,s,t)=>{"use strict";t.d(s,{d:()=>n});var a=t(95155),l=t(12115),r=t(27599),i=t(64269);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.bL,{className:(0,i.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,ref:s,children:(0,a.jsx)(r.zi,{className:(0,i.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});n.displayName=r.bL.displayName},57249:(e,s,t)=>{"use strict";t.d(s,{A:()=>j});var a=t(95155),l=t(12115),r=t(3998),i=t(76444),n=t(31120),c=t(86948),o=t(95740),d=t(17666),u=t(23327),h=t(42196),m=t(35299),p=t(18720),x=t(15239);let g={event:{title:"Event Image Tips",tips:["Include the event type (party, meeting, fundraiser, sports)","Mention the setting (school, outdoor, gymnasium, auditorium)","Specify the mood (fun, energetic, celebratory, professional)","Add visual elements (balloons, decorations, people, activities)"],example:"Vibrant school fundraiser with colorful balloons, happy families, bake sale table, outdoor setting, sunny day, professional photography style"},news:{title:"News Article Tips",tips:["Focus on the story theme (achievement, announcement, community)","Include relevant imagery (students, teachers, school building)","Specify the tone (inspiring, informative, celebratory)","Add contextual elements that support the story"],example:"Inspiring school achievement photo, students celebrating, graduation caps in air, diverse group, joyful expressions, professional news style"},volunteer:{title:"Volunteer Opportunity Tips",tips:["Show the activity type (organizing, helping, teaching)","Include people working together (teamwork, collaboration)","Specify the environment (classroom, outdoor, event space)","Convey a helpful and welcoming atmosphere"],example:"Friendly volunteers organizing school event, diverse group working together, colorful materials, indoor classroom, warm lighting, professional photo"},general:{title:"Image Generation Tips",tips:["Be specific and descriptive","Mention colors, mood, and setting","Include what you want to see","Specify the style (photo, illustration, modern, vibrant)"],example:"Modern school community event, diverse families enjoying activities, colorful setting, professional photography style"}};function j(e){let{title:s,description:t,onImageGenerated:j,defaultPrompt:f="",category:v="general"}=e,[b,y]=(0,l.useState)(f),[N,w]=(0,l.useState)(null),[_,C]=(0,l.useState)(!1),[I,k]=(0,l.useState)(!1),A=g[v],S=async()=>{if(!b.trim())return void p.o.error("Please enter a prompt");C(!0);try{let e=await fetch("/api/generate-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:b})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to generate image");w(s.imageUrl),p.o.success("Image generated successfully!")}catch(e){console.error("Error generating image:",e),p.o.error(e instanceof Error?e.message:"Failed to generate image")}finally{C(!1)}};return(0,a.jsxs)(c.Zp,{className:"border-2 border-primary/20",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"w-5 h-5 text-primary"}),s]}),t&&(0,a.jsx)(c.BT,{className:"mt-1",children:t})]}),(0,a.jsxs)(r.$,{variant:"ghost",size:"sm",onClick:()=>k(!I),className:"text-muted-foreground",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-1"}),I?"Hide":"Show"," Tips"]})]})}),(0,a.jsxs)(c.Wu,{className:"space-y-4",children:[I&&(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(u.A,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-900",children:A.title}),(0,a.jsx)("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside",children:A.tips.map((e,s)=>(0,a.jsx)("li",{children:e},s))}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>{y(A.example),p.o.success("Example prompt loaded!")},className:"text-xs border-blue-300 text-blue-700 hover:bg-blue-100",children:"Use Example Prompt"})})]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(i.J,{htmlFor:"prompt",className:"flex items-center gap-2",children:["Image Description",(0,a.jsx)("span",{className:"text-xs text-muted-foreground font-normal",children:"(Be specific and descriptive)"})]}),(0,a.jsx)(n.T,{id:"prompt",value:b,onChange:e=>y(e.target.value),placeholder:"Describe the image you want to generate...",rows:4,className:"resize-none"})]}),N&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(i.J,{children:"Generated Image"}),(0,a.jsx)("div",{className:"relative w-full aspect-video rounded-lg overflow-hidden border-2 border-primary/20",children:(0,a.jsx)(x.default,{src:N,alt:"Generated image",fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, 600px"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(r.$,{onClick:()=>{N&&(j(N),p.o.success("Image added!"),w(null),y(""))},className:"flex-1",children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-2"}),"Use This Image"]}),(0,a.jsx)(r.$,{variant:"outline",onClick:()=>w(null),children:"Discard"})]})]}),!N&&(0,a.jsx)(r.$,{onClick:S,disabled:_||!b.trim(),className:"w-full",size:"lg",children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"Generate Image with AI"]})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Powered by Google Gemini AI • Images generated are royalty-free"})]})]})}},96648:(e,s,t)=>{"use strict";t.d(s,{U:()=>l});var a=t(88727);function l(){return(0,a.createBrowserClient)("https://whtwuisrljgjtpzbyhfp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndodHd1aXNybGpnanRwemJ5aGZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0NzgzMjAsImV4cCI6MjA3NjA1NDMyMH0.U_D-Zv0Qpev9_QIBRRRidzAGffpHVIpaIeGZhu_gKDw")}}},e=>{e.O(0,[4909,2619,5239,3529,8720,2659,1691,9065,6825,5313,9996,1431,8441,1255,7358],()=>e(e.s=43217)),_N_E=e.O()}]);