(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3491],{5167:(e,s,l)=>{"use strict";l.d(s,{eC:()=>t,w3:()=>r,wQ:()=>a});let a={all:{label:"All Campuses",bgColor:"bg-primary",textColor:"text-primary-foreground"},preschool:{label:"Preschool",bgColor:"bg-purple-500",textColor:"text-white"},elementary:{label:"Elementary",bgColor:"bg-blue-500",textColor:"text-white"},"middle-high":{label:"Middle & High School",bgColor:"bg-teal-500",textColor:"text-white"}},t={"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/webp":[".webp"],"image/gif":[".gif"]},r=0xa00000},8285:(e,s,l)=>{Promise.resolve().then(l.bind(l,64251))},11647:(e,s,l)=>{"use strict";l.d(s,{E:()=>n});var a=l(95155);l(12115);var t=l(83101),r=l(64269);let i=(0,t.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:l,...t}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:l}),s),...t})}},64251:(e,s,l)=>{"use strict";l.d(s,{AdminPageClient:()=>B});var a=l(95155),t=l(12115),r=l(20063),i=l(61362),n=l(78874),c=l(6191),d=l(57828),o=l(70532),u=l(93499),h=l(71360),m=l(21786),x=l(50042),p=l(16082),v=l(3998),b=l(86948),j=l(65142),g=l(76444),f=l(31120),N=l(11186),y=l(51834),w=l(11647),C=l(11636),A=l(1733),S=l(26497),k=l(6132),U=l(65229),E=l(42196),M=l(5917),R=l(64269),P=l(5167);function F(e){let{onFilesSelected:s,maxFiles:l=20,className:r,disabled:i=!1}=e,[n,c]=t.useState([]),[d,o]=t.useState([]),u=t.useCallback((e,l)=>{let a=e.map(e=>(e.preview=URL.createObjectURL(e),e)),t=l.map(e=>{var s;return{file:e.file.name,error:(null==(s=e.errors[0])?void 0:s.message)||"Invalid file"}});c(e=>[...e,...a]),o(e=>[...e,...t]),s([...n,...a])},[n,s]),{getRootProps:h,getInputProps:x,isDragActive:p}=(0,C.VB)({onDrop:u,accept:P.eC,maxSize:P.w3,maxFiles:l,disabled:i,multiple:!0}),b=t.useCallback(e=>{c(l=>{let a=[...l];return a[e].preview&&URL.revokeObjectURL(a[e].preview),a.splice(e,1),s(a),a})},[s]),j=t.useCallback(()=>{o([])},[]);return t.useEffect(()=>()=>{n.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)})},[n]),(0,a.jsxs)("div",{className:(0,R.cn)("space-y-4",r),children:[(0,a.jsxs)("div",{...h(),className:(0,R.cn)("relative border-2 border-dashed rounded-lg transition-all duration-200","flex flex-col items-center justify-center p-12 cursor-pointer","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",p?"border-primary bg-primary/5 scale-[1.02]":"border-muted-foreground/25 hover:border-primary/50 hover:bg-muted/50",i&&"opacity-50 cursor-not-allowed pointer-events-none"),children:[(0,a.jsx)("input",{...x()}),(0,a.jsxs)(A.P.div,{initial:!1,animate:p?{scale:1.05}:{scale:1},className:"flex flex-col items-center text-center",children:[(0,a.jsx)("div",{className:(0,R.cn)("mb-4 p-4 rounded-full transition-colors",p?"bg-primary/10":"bg-muted"),children:(0,a.jsx)(m.A,{className:(0,R.cn)("h-10 w-10 transition-colors",p?"text-primary":"text-muted-foreground"),"aria-hidden":"true"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:p?"Drop photos here":"Upload Photos"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4 max-w-sm",children:"Drag and drop photos here, or click to browse your files"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,a.jsxs)(w.E,{variant:"outline",className:"text-xs",children:["Max ",l," files"]}),(0,a.jsxs)(w.E,{variant:"outline",className:"text-xs",children:["Max ",P.w3/1024/1024,"MB per file"]}),(0,a.jsx)(w.E,{variant:"outline",className:"text-xs",children:"JPG, PNG, WEBP, GIF"})]})]})]}),(0,a.jsx)(S.N,{children:d.length>0&&(0,a.jsx)(A.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(k.A,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-semibold text-destructive mb-2",children:"Upload Errors"}),(0,a.jsx)("ul",{className:"space-y-1 text-sm text-destructive/90",children:d.map((e,s)=>(0,a.jsxs)("li",{className:"truncate",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.file,":"]})," ",e.error]},s))})]}),(0,a.jsx)(v.$,{variant:"ghost",size:"icon",onClick:j,className:"flex-shrink-0 hover:bg-destructive/20","aria-label":"Clear errors",children:(0,a.jsx)(U.A,{className:"h-4 w-4"})})]})})}),n.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h4",{className:"font-semibold text-sm",children:["Selected Files (",n.length,")"]}),(0,a.jsx)(v.$,{variant:"outline",size:"sm",onClick:()=>{n.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)}),c([]),s([])},className:"text-xs",children:"Clear All"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:(0,a.jsx)(S.N,{children:n.map((e,s)=>(0,a.jsxs)(A.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},className:"relative group",children:[(0,a.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted",children:[e.preview?(0,a.jsx)("img",{src:e.preview,alt:e.name,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)(E.A,{className:"h-12 w-12 text-muted-foreground/30"})}),(0,a.jsx)(v.$,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>b(s),"aria-label":"Remove ".concat(e.name),children:(0,a.jsx)(U.A,{className:"h-4 w-4"})}),(0,a.jsx)("div",{className:"absolute bottom-2 left-2",children:(0,a.jsxs)(w.E,{variant:"secondary",className:"text-xs flex items-center gap-1 bg-green-500/90 text-white",children:[(0,a.jsx)(M.A,{className:"h-3 w-3"}),"Ready"]})})]}),(0,a.jsxs)("div",{className:"mt-2 px-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium truncate",title:e.name,children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:(e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,s)*100)/100+" "+["Bytes","KB","MB"][s]})(e.size)})]})]},e.name+s))})})]})]})}var _=l(30926);let L=(0,_.createServerReference)("400e6cfcb05c2bbebcef17f81036ddc9c437dcf135",_.callServer,void 0,_.findSourceMapURL,"createAlbum"),D=(0,_.createServerReference)("60ba5bc0fe5d1b3daa9e6909f4dd51a12c71c79ef7",_.callServer,void 0,_.findSourceMapURL,"uploadPhotos"),$=(0,_.createServerReference)("4042fe320d982743661e0c69787cde7536aa078bda",_.callServer,void 0,_.findSourceMapURL,"deleteAlbum"),z=(0,_.createServerReference)("6027b15299136addbc1e213110962872e452659f83",_.callServer,void 0,_.findSourceMapURL,"updateAlbumPublishStatus");function B(e){let{albums:s}=e,l=(0,r.useRouter)(),[d,o]=t.useState(!1),[u,h]=t.useState(null),[m,x]=t.useState(null);return(0,a.jsxs)("div",{className:"space-y-8",children:[m&&(0,a.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800 flex items-start gap-2",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),(0,a.jsx)("div",{className:"flex-1",children:m}),(0,a.jsx)(v.$,{variant:"ghost",size:"sm",onClick:()=>x(null),className:"h-auto p-0 hover:bg-transparent",children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)(b.Zp,{children:[(0,a.jsx)(b.aR,{children:(0,a.jsxs)(b.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),"Create New Album"]})}),(0,a.jsx)(b.Wu,{children:(0,a.jsx)(O,{isCreating:d,onCreateStart:()=>o(!0),onCreateComplete:(e,s)=>{o(!1),e&&s&&(x("Album created successfully. You can now upload photos."),l.refresh())}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Manage Albums"}),(0,a.jsxs)("div",{className:"grid gap-6",children:[s.map(e=>(0,a.jsx)(J,{album:e,isUploading:u===e.id,onUploadStart:()=>h(e.id),onUploadComplete:()=>{h(null),l.refresh()},onDelete:()=>{l.refresh()},onPublishToggle:()=>{l.refresh()}},e.id)),0===s.length&&(0,a.jsx)(b.Zp,{children:(0,a.jsx)(b.Wu,{className:"py-12 text-center text-muted-foreground",children:"No albums yet. Create your first album above."})})]})]})]})}function O(e){let{isCreating:s,onCreateStart:l,onCreateComplete:r}=e,[i,c]=t.useState(null),[d,o]=t.useState({title:"",description:"",event_date:"",location:"",campus:"all",published:!1}),u=async e=>{e.preventDefault(),c(null),l();let s=await L(d);s.success?(o({title:"",description:"",event_date:"",location:"",campus:"all",published:!1}),r(!0,s.slug)):(c(s.error||"Failed to create album"),r(!1))};return(0,a.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"title",children:"Album Title *"}),(0,a.jsx)(j.p,{id:"title",value:d.title,onChange:e=>o({...d,title:e.target.value}),placeholder:"Spring Festival 2025",required:!0,disabled:s})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"campus",children:"Campus *"}),(0,a.jsxs)(N.l6,{value:d.campus,onValueChange:e=>o({...d,campus:e}),disabled:s,children:[(0,a.jsx)(N.bq,{id:"campus",children:(0,a.jsx)(N.yv,{})}),(0,a.jsxs)(N.gC,{children:[(0,a.jsx)(N.eb,{value:"all",children:"All Campuses"}),(0,a.jsx)(N.eb,{value:"preschool",children:"Preschool"}),(0,a.jsx)(N.eb,{value:"elementary",children:"Elementary"}),(0,a.jsx)(N.eb,{value:"middle-high",children:"Middle & High School"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)(g.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(p.Y,{onApply:e=>o({...d,description:e}),contentType:"event",currentContent:d.description,context:{title:d.title,campus:[d.campus]}})]}),(0,a.jsx)(f.T,{id:"description",value:d.description,onChange:e=>o({...d,description:e.target.value}),placeholder:"Brief description of the event or album",rows:3,disabled:s})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"event_date",children:"Event Date"}),(0,a.jsx)(j.p,{id:"event_date",type:"date",value:d.event_date,onChange:e=>o({...d,event_date:e.target.value}),disabled:s})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"location",children:"Location"}),(0,a.jsx)(j.p,{id:"location",value:d.location,onChange:e=>o({...d,location:e.target.value}),placeholder:"Main Courtyard",disabled:s})]})]}),i&&(0,a.jsxs)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-lg text-sm text-destructive flex items-start gap-2",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 flex-shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:i})]}),(0,a.jsx)(v.$,{type:"submit",disabled:s,children:s?"Creating...":"Create Album"})]})}function J(e){let{album:s,isUploading:l,onUploadStart:r,onUploadComplete:c,onDelete:p,onPublishToggle:j}=e,[g,f]=t.useState(!1),[N,C]=t.useState(!1),[A,S]=t.useState([]),[k,U]=t.useState(!1),[E,M]=t.useState(!1),[_,L]=t.useState(null),[B,O]=t.useState(null),J=async()=>{if(0===A.length)return void L("Please select photos to upload");L(null),O(null),r();let e=new FormData;A.forEach(s=>{e.append("files",s)});let l=await D(s.id,e);if(l.success){var a;O("".concat((null==(a=l.photoIds)?void 0:a.length)||0," photos uploaded successfully")),S([]),f(!1),c()}else L(l.error||"Failed to upload photos"),c()},T=async()=>{U(!0),L(null);let e=await $(s.id);e.success?(C(!1),p()):L(e.error||"Failed to delete album"),U(!1)},G=async()=>{M(!0),L(null),O(null);let e=await z(s.id,!s.published);e.success?(O("Album ".concat(s.published?"unpublished":"published"," successfully")),j()):L(e.error||"Failed to update album"),M(!1)},Z=Array.isArray(s.campus)?s.campus[0]:s.campus,W=P.wQ[Z||"all"],q=s.event_date?new Date(s.event_date):null;return(0,a.jsxs)(b.Zp,{children:[(0,a.jsx)(b.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.ZB,{children:s.title}),(0,a.jsx)(w.E,{className:(0,R.cn)(W.bgColor,W.textColor,"border-none"),children:W.label}),s.published?(0,a.jsxs)(w.E,{variant:"default",className:"bg-green-500",children:[(0,a.jsx)(d.A,{className:"h-3 w-3 mr-1"}),"Published"]}):(0,a.jsxs)(w.E,{variant:"secondary",children:[(0,a.jsx)(o.A,{className:"h-3 w-3 mr-1"}),"Draft"]})]}),(0,a.jsxs)("div",{className:"flex gap-4 text-sm text-muted-foreground",children:[q&&(0,a.jsx)("span",{children:(0,x.GP)(q,"MMM d, yyyy")}),(0,a.jsxs)("span",{children:[s.photo_count," photos"]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[s.published&&(0,a.jsx)(v.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,a.jsx)("a",{href:"/gallery/".concat(s.slug),target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(u.A,{className:"h-4 w-4"})})}),(0,a.jsx)(v.$,{variant:"outline",size:"sm",onClick:G,disabled:E,children:s.published?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Unpublish"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Publish"]})}),(0,a.jsxs)(y.lG,{open:N,onOpenChange:C,children:[(0,a.jsx)(y.zM,{asChild:!0,children:(0,a.jsx)(v.$,{variant:"destructive",size:"sm",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(y.Cf,{children:[(0,a.jsxs)(y.c7,{children:[(0,a.jsx)(y.L3,{children:"Delete Album"}),(0,a.jsxs)(y.rr,{children:["Are you sure you want to delete this album? This will permanently delete all ",s.photo_count," photos in this album. This action cannot be undone."]})]}),(0,a.jsxs)(y.Es,{children:[(0,a.jsx)(v.$,{variant:"outline",onClick:()=>C(!1),disabled:k,children:"Cancel"}),(0,a.jsx)(v.$,{variant:"destructive",onClick:T,disabled:k,children:k?"Deleting...":"Delete Album"})]})]})]})]})]})}),s.description&&(0,a.jsx)(b.Wu,{children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.description})}),(0,a.jsxs)(b.wL,{className:"flex-col items-stretch gap-4",children:[B&&(0,a.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800 flex items-start gap-2",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 flex-shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:B})]}),_&&(0,a.jsxs)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-lg text-sm text-destructive flex items-start gap-2",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 flex-shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:_})]}),(0,a.jsxs)(v.$,{variant:"outline",onClick:()=>f(!g),className:"w-full",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),g?"Hide Upload":"Upload Photos"]}),g&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsx)(F,{onFilesSelected:S,maxFiles:50,disabled:l}),A.length>0&&(0,a.jsx)(v.$,{onClick:J,disabled:l,className:"w-full",children:l?"Uploading...":"Upload ".concat(A.length," Photo").concat(1===A.length?"":"s")})]})]})]})}}},e=>{e.O(0,[4909,1733,3529,8720,2659,1691,42,9065,519,9996,8441,1255,7358],()=>e(e.s=8285)),_N_E=e.O()}]);